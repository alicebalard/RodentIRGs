# A. Balard
# October 2021
# Analyses done on Harriet server from Heitlinger team

library(tidyr)

## We match the OrthoFinder results with the known IRG names in Mmus
tabRef <- read.csv("/SAN/Alices_sandpit/Torelli_transcriptomics/GIT/RodentIRGs/data/Table1_IRGs_naming.csv")

tabOF <- read.csv("/SAN/Alices_sandpit/Torelli_transcriptomics/GIT/RodentIRGs/data/orthofinder_results/N0_HOG_IRG.tsv", sep="\t")

head(tabOF)

head(tabRef)

tabRef <- tabRef[c("Name_Bekpen_2005", "proteins_GRCm39")]

## rm empty rows: pseudo genes, or not found (Irgb4)
tabRef <- tabRef[!tabRef$proteins_GRCm39 %in% "",]
tabRef <- tabRef[!tabRef$proteins_GRCm39 %in% "?",]

tabRef$proteins_GRCm39  <- gsub(" ", "", tabRef$proteins_GRCm39)

## one protein name per line with amazing separate_rows()
tabRef <- data.frame(separate_rows(tabRef, proteins_GRCm39, sep = ";"))

tabOF <- data.frame(separate_rows(tabOF, Mmus_GCF_000001635.27_GRCm39_protein, sep=", "))

head(tabOF)

# rename a column before merging
tabOF$proteins_GRCm39 <- tabOF$Mmus_GCF_000001635.27_GRCm39_protein


tabMERGED <- merge(tabRef, tabOF)

tabMERGED[c(1,2, 3)]


tabRef$proteins_GRCm39
