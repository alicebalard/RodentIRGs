#   # mutate(irgName=paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", A), ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x[["number"]] <- numeric()
# N <- x %>%
#   group_by(A) #%>%
#   # mutate(irgName=paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", A), ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# N <- x %>%
#   group_by(A) #%>%
#   # mutate(irgName=paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", A), ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# N <- x %>%
#   group_by(A) #%>%
#   # mutate(irgName=paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", A), ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
)
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# N <- x %>%
#   group_by(A) #%>%
#   # mutate(irgName=paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", A), ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# N <- x %>%
#   group_by(A) #%>%
#   # mutate(irgName=paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", A), ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# N <- x %>%
#   group_by(A) #%>%
#   # mutate(irgName=paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", A), ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) #%>%
#   # mutate(irgName=paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", A), ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName = paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", A))
N <- x %>%
group_by(A) #%>%
#   # mutate(irgName=paste0( ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName = paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A))
N <- x %>%
group_by(A) #%>%
#   # mutate(irgName=paste0( ".",cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName = paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".")
N <- x %>%
group_by(A) #%>%
mutate(irgName=paste0(startName, cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName = paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".")
N <- x %>%
group_by(A) #%>%
mutate(irgName=cumsum(number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
N <- x %>%
group_by(A) #%>%
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName = paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".")
N <- x %>%
group_by(A) #%>%
mutate(irgName=paste0(startName, cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName = paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".")
N <- x %>%
group_by(A) #%>%
mutate(irgName=paste0(startName, cumsum(x$number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName = paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".")
N <- x %>%
group_by(A) %>%
mutate(irgName=paste0(startName, cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName = paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".")
startName
# N <- x %>%
# group_by(A) %>%
# mutate(irgName=paste0(startName, cumsum(number)))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName = paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".")
startName
N <- x %>%
group_by(A) %>%
# mutate(irgName=paste0(startName, cumsum(number)))
mutate(irgName=cumsum(number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
startName =
startName
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".", x$number)
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".", x$number)
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".", x$number)
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
vecFas <- vector()
## prepare the fasta file format (including a counter for each IRG)
test <- newdfList[[1]]
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".", x$number)
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
sapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".", x$number)
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".", x$number)
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
unlist(lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".", x$number)
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}))
unlist(lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".", x$number)
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}))
prefasta <- unlist(lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names(rodentsAsQuery)[1], "_", gsub("Mmus_", "", x$A), ".", x$number)
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}))
prefasta
gsub("-", "", prefasta)
prefasta <- gsub("-", "", prefasta)
prefasta
prefasta
newdfList
## prepare the fasta file format (including a counter for each IRG)
test <- newdfList[[1]]
View(test)
## prepare the fasta file format (including a counter for each IRG)
test <- newdfList[[2]]
View(test)
names(newdfList)
names(rodentsAsQuery)
## rename the list:
names(newdfList) <- names(rodentsAsQuery)
names(newdfList[[1]])
names(newdfList[1])
})
# for each rodent species
newdfList <- lapply(dfList, function(x){
# for each line
newdf <- data.frame()
for (i in 1:nrow(x)){
t <- x[i,]
subtab <- x[(x$B %in% t$B &
x$C %in% (t$C + c(-150:150)) &
x$D %in% (t$D + c(-150:150))),]
newdf <- rbind(newdf,
subtab[subtab$EaR %in% min(subtab$EaR) & subtab$FaR %in% max(subtab$FaR),])
}
newdf <- unique(newdf)
return(newdf)
})
newdfList
View(newdfList)
# for each rodent species
newdfList <- lapply(dfList, function(x){
# for each line
newdf <- data.frame()
for (i in 1:nrow(x)){
t <- x[i,]
subtab <- x[(x$B %in% t$B &
x$C %in% (t$C + c(-150:150)) &
x$D %in% (t$D + c(-150:150))),]
newdf <- rbind(newdf,
subtab[subtab$EaR %in% min(subtab$EaR) & subtab$FaR %in% max(subtab$FaR),])
}
newdf <- unique(newdf)
return(newdf)
})
# for each rodent species
newdfList <- lapply(dfList, function(x){
# for each line
newdf <- data.frame()
for (i in 1:nrow(x)){
t <- x[i,]
subtab <- x[(x$B %in% t$B &
x$C %in% (t$C + c(-150:150)) &
x$D %in% (t$D + c(-150:150))),]
newdf <- rbind(newdf,
subtab[subtab$EaR %in% min(subtab$EaR) & subtab$FaR %in% max(subtab$FaR),])
}
newdf <- unique(newdf)
return(newdf)
})
# Check if exact same hit for 2 different IRG (e.g. Irgb6 and b6*) and merge
newdfList <- lapply(newdfList, function(x){
x <- x[!duplicated(paste(x$B, x$C, x$D)),]
})
vecFas <- vector()
## prepare the fasta file format (including a counter for each IRG)
test <- newdfList[[2]]
## rename the list:
names(newdfList) <- names(rodentsAsQuery)
prefasta <- lapply(newdfList, function(x){
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
prefasta <- gsub("-", "", prefasta)
prefasta
prefasta
))
prefasta <- gsub("-", "", prefasta)
prefasta
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
x$species = names(rodentsAsQuery)
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
prefasta <- gsub("-", "", prefasta)
prefasta
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
x$species = names(x)
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
x$species = names(x)[[]]
N <- x %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# x$species =
names(x)[[]]
# N <- x %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# x$species =
names(x)[]
# N <- x %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# x$species =
names(x)
# N <- x %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# x$species =
print(names(x))
# N <- x %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
# x$species =
print(names(x)[])
# x$species =
print(names(x)[[]]])
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# x$species =
print(names(x)[[]]])
# N <- x %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
prefasta <- lapply(newdfList, function(x){
x$number = rep(1, nrow(x))
# x$species =
print(names(x)[[]])
# N <- x %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
})
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
vecFas <- vector()
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = names(newdfList)[[i]]
N <- newdfList[[i]] %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", x$A), ".", x$number))
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = names(newdfList)[[i]]
N <- newdfList[[i]] %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names((x), "_", gsub("Mmus_", "", newdfList[[i]]$A), ".", newdfList[[i]]$number))
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = names(newdfList)[[i]]
N <- newdfList[[i]] %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names((newdfList[[i]]), "_", gsub("Mmus_", "", newdfList[[i]]$A), ".", newdfList[[i]]$number))
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = names(newdfList)[[i]]
# N <- newdfList[[i]] %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((newdfList[[i]]), "_", gsub("Mmus_", "", newdfList[[i]]$A), ".", newdfList[[i]]$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
# newdfList[[i]]$species = names(newdfList)[[i]]
# N <- newdfList[[i]] %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((newdfList[[i]]), "_", gsub("Mmus_", "", newdfList[[i]]$A), ".", newdfList[[i]]$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = names(newdfList)[i]
# N <- newdfList[[i]] %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((newdfList[[i]]), "_", gsub("Mmus_", "", newdfList[[i]]$A), ".", newdfList[[i]]$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = rep(names(newdfList)[i], nrow(newdfList[[i]]))
# N <- newdfList[[i]] %>%
#   group_by(A) %>%
#   mutate(counter=cumsum(number))
# N$irgName <- paste0(names((newdfList[[i]]), "_", gsub("Mmus_", "", newdfList[[i]]$A), ".", newdfList[[i]]$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = rep(names(newdfList)[i], nrow(newdfList[[i]]))
N <- newdfList[[i]] %>%
group_by(A) %>%
mutate(counter=cumsum(number))
# N$irgName <- paste0(names((newdfList[[i]]), "_", gsub("Mmus_", "", newdfList[[i]]$A), ".", newdfList[[i]]$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = rep(names(newdfList)[i], nrow(newdfList[[i]]))
N <- newdfList[[i]] %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(names((newdfList[[i]]), "_", gsub("Mmus_", "", newdfList[[i]]$A), ".", newdfList[[i]]$number))
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = rep(names(newdfList)[i], nrow(newdfList[[i]]))
N <- newdfList[[i]] %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(N$species, "_", gsub("Mmus_", "", N$A), ".", N$number)
# vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
# prefasta <- lapply(newdfList, function(x){
for (i in 1:length(newdfList)){
newdfList[[i]]$number = rep(1, nrow(newdfList[[i]]))
newdfList[[i]]$species = rep(names(newdfList)[i], nrow(newdfList[[i]]))
N <- newdfList[[i]] %>%
group_by(A) %>%
mutate(counter=cumsum(number))
N$irgName <- paste0(N$species, "_", gsub("Mmus_", "", N$A), ".", N$number)
vecFas <- c(vecFas, paste0(">", N$irgName, "\n", N$seq))
}
vecFas
prefasta <- gsub("-", "", vecFas)
prefasta
# Save fasta file
write.table(prefasta, "../data/candidatesFromRBBH.fasta", quote = F, col.names = F)
# Save fasta file
write.table(prefasta, "../data/candidatesFromRBBH.fasta", quote = F, col.names = F, row.names = F)
# Save fasta file
write.table(prefasta, "../data/fasta_sequences/candidatesFromRBBH.fasta", quote = F, col.names = F, row.names = F)
